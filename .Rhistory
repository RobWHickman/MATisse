scale_fill_continuous(low = "lightblue", high = "darkred", name = "number of trials")
head(task_data)
ggplot(test[, .(.N), by = .(offer_ml, bundle_liquid)], aes(x = offer_ml, y = bundle_liquid)) +
geom_tile(aes(fill = N)) +
scale_fill_continuous(low = "lightblue", high = "darkred", name = "number of trials") +
xlab("bundle juice offer") +
_
ggplot(test[, .(.N), by = .(offer_ml, bundle_liquid)], aes(x = offer_ml, y = bundle_liquid)) +
geom_tile(aes(fill = N)) +
scale_fill_continuous(low = "lightblue", high = "darkred", name = "number of trials") +
xlab("bundle juice offer") +
ylab("bundle water offer")
test <- task_data[, list(fractal_bid, offer_value, bundle_liquid, offer_ml)]
ggplot(data = test, aes(x = bundle_liquid, y = fractal_bid, colour = offer_value)) + geom_point(size = 3, alpha = 0.1)
ggplot(test[, .(.N), by = .(offer_ml, bundle_liquid)], aes(x = offer_ml, y = bundle_liquid)) +
geom_tile(aes(fill = N)) +
scale_fill_continuous(low = "lightblue", high = "darkred", name = "number of trials") +
xlab("bundle juice offer") +
ylab("bundle water offer")
test <- task_data[, list(fractal_bid, offer_value, bundle_liquid)]
ggplot(data = test, aes(x = bundle_liquid, y = fractal_bid, colour = offer_value)) + geom_point(size = 3, alpha = 0.1)
ggplot(test[, .(.N), by = .(offer_ml, bundle_liquid)], aes(x = ((offer_value*2 -1) * 0.15), y = bundle_liquid)) +
geom_tile(aes(fill = N)) +
scale_fill_continuous(low = "lightblue", high = "darkred", name = "number of trials") +
xlab("bundle juice offer") +
ylab("bundle water offer")
test <- task_data[, list(fractal_bid, offer_value, bundle_liquid)]
ggplot(data = test, aes(x = bundle_liquid, y = fractal_bid, colour = offer_value)) + geom_point(size = 3, alpha = 0.1)
ggplot(test[, .(.N), by = .(offer_value, bundle_liquid)], aes(x = ((offer_value*2 -1) * 0.15), y = bundle_liquid)) +
geom_tile(aes(fill = N)) +
scale_fill_continuous(low = "lightblue", high = "darkred", name = "number of trials") +
xlab("bundle juice offer") +
ylab("bundle water offer")
head(test)
test2 <- test[, .(fractal_bid), by = .(offer_value, bundle_liquid)]
test2
View(test2)
View(test)
test2 <- test[, sum(fractal_bid), by = .(offer_value, bundle_liquid)]
test2
test2 <- test[, bids := sum(fractal_bid), by = .(offer_value, bundle_liquid)]
test2
View(test2)
test2 <- test[fractal_bids == 1, .N, by = .(offer_value, bundle_liquid)]
test2
test2 <- test[fractal_bid == 1, .N, by = .(offer_value, bundle_liquid)]
test2
test2 <- test[fractal_bid == 1, fractal_bids := .N, by = .(offer_value, bundle_liquid)] %>%
.[, total_bids := .N, by = .(offer_value, bundle_liquid)]
test2
View(test2)
p1
test2 <- test[fractal_bid == 1, fractal_bids := .N, by = .(offer_value, bundle_liquid)]
test2 <- test[fractal_bid == 1, fractal_bids := .N, by = .(offer_value, bundle_liquid)] %>%
.[, total_bids := .N, by = .(offer_value, bundle_liquid)] %>%
.[, fractal_perc := fractal_bids / total_bids]
View(test2)
test2 <- test[!is.na(fractal_bid)] %>%
.[fractal_bid == 1, fractal_bids := .N, by = .(offer_value, bundle_liquid)] %>%
.[, total_bids := .N, by = .(offer_value, bundle_liquid)] %>%
.[, fractal_perc := fractal_bids / total_bids]
View(test2)
test2 <- test[!is.na(fractal_bid)] %>%
.[fractal_bid == 1, fractal_bids := mean(fractal_bids), by = .(offer_value, bundle_liquid)]
test2 <- test[!is.na(fractal_bid)] %>%
.[, fractal_bids := mean(fractal_bids), by = .(offer_value, bundle_liquid)]
class(test$fractal_bid)
test2 <- test[!is.na(fractal_bid)] %>%
.[, fractal_bids := mean(fractal_bid), by = .(offer_value, bundle_liquid)]
test2 <- test[!is.na(fractal_bid)] %>%
.[, fractal_bids := mean(as.numeric(fractal_bid)), by = .(offer_value, bundle_liquid)]
test2 <- test[!is.na(fractal_bid)] %>%
.[, fractal_bids := mean(as.integer(fractal_bid)), by = .(offer_value, bundle_liquid)]
test2
test2 <- test[!is.na(fractal_bid)] %>%
.[, fractal_bids := mean(fractal_bid), by = .(offer_value, bundle_liquid)]
test2
test <- task_data[, list(fractal_bid, offer_value, bundle_liquid)]
ggplot(data = test, aes(x = bundle_liquid, y = fractal_bid, colour = offer_value)) + geom_point(size = 3, alpha = 0.1)
ggplot(test[, .(.N), by = .(offer_value, bundle_liquid)], aes(x = ((offer_value*2 -1) * 0.15), y = bundle_liquid)) +
geom_tile(aes(fill = N)) +
scale_fill_continuous(low = "lightblue", high = "darkred", name = "number of trials") +
xlab("bundle juice offer") +
ylab("bundle water offer")
test2 <- test[!is.na(fractal_bid)] %>%
.[, fractal_bids := mean(fractal_bid), by = .(offer_value, bundle_liquid)]
test2
View(test2)
test2 <- test[!is.na(fractal_bid)] %>%
.[, fractal_bids := mean(fractal_bid), by = .(offer_value, bundle_liquid)] %>%
.[, fractal_bid := NULL] %>%
unique()
test2
test2 <- test[!is.na(fractal_bid)] %>%
.[, mean(fractal_bid), by = .(offer_value, bundle_liquid)]
test2
test2 <- test[!is.na(fractal_bid)] %>%
.[, mean(fractal_bid), by = .(offer_value, bundle_liquid)]
test2
View(test2)
head(task_data)
require(ggplot2)
require(ggthemes)
require(dplyr)
require(magrittr)
require(data.table)
require(tidyr)
#load in specific data
date <- "11-Dec-2017"
monkey <- "Ulysses"
search_string <- paste0(date, ".*", monkey, "COMPACT")
#find all data files
data_files <- dir("../savefiles")
#load in the relevant data
specific_files <- data_files[grep(search_string, data_files)]
task_data <- rbindlist(lapply(paste0("../savefiles/", specific_files), read.csv, na.strings = "NaN"), idcol = "block") %>%
#munge the data
.[, block := paste("block", block)] %>%
.[, trial:= 1:.N, block] %>%
.[bundle_position == 1, bundle_distance := (monkey_final_bid + 1)/2] %>%
.[bundle_position == 0, bundle_distance := (1-monkey_final_bid)/2] %>%
.[bundle_distance < 0.5, fractal_bid := 1] %>%
.[bundle_distance > 0.5, fractal_bid := 0] %>%
.[, offer_ml := paste0(((offer_value*2)-1) * 0.15, "ml")] %>%
.[, bundle_liquid := 1 - bundle_water_perc]
date
monkey
#plot the left vs right choices of the monkey
p1 <- ggplot(data = task_data, aes(x = monkey_final_bid, y = bundle_position)) +
geom_point(alpha = 0.4, aes(colour = trial, size = offer_value, shape = as.factor(fractal_bid))) +
scale_colour_continuous(low = "blue", high = "red", name = "trial number") +
scale_size_continuous(range = c(4,6), name = "juice offered") +
scale_shape_manual(values = c(15,16), name = "juice chosen") +
xlab("bid position") +
ylab("fractal position") +
annotate("text", label = "left bid", x = -0.5, y = 0.45, size = 7, colour = "darkgrey") +
annotate("text", label = "right bid", x = 0.5, y = 0.45, size = 7, colour = "darkgrey") +
ggtitle("Monkey Bid Positions on Binary Choice Task",
subtitle = paste(date, ";", monkey, ";", length(unique(task_data$block)), "blocks")) +
#theme_fivethirtyeight() +
theme_minimal() +
theme(strip.text.x = element_text(size = 14)) +
theme(axis.title.x = element_text(size = 14)) +
theme(axis.title.y = element_text(size = 14)) +
facet_wrap("block")
#plot p1
p1
#plot the distance from the bundle (0-1 of screen width) of the final bid
p2 <- ggplot(data = task_data, aes(x = bundle_distance, colour = as.factor(offer_ml))) +
geom_freqpoly(size = 3, alpha = 0.75) +
scale_colour_brewer(palette = "Set1", name = "fractal value") +
xlab("bid distance from bundle edge") +
ylab("count") +
annotate("text", label = "bundle bid", x = 0.05, y = 4, size = 7, colour = "darkgrey") +
annotate("text", label = "budget bid", x = 0.75, y = 4, size = 7, colour = "darkgrey") +
ggtitle("Monkey Bid Distance From Bundle on Binary Choice Task",
subtitle = paste(date, ";", monkey, ";", length(unique(task_data$block)), "blocks")) +
#theme_fivethirtyeight() +
theme_minimal() +
theme(strip.text.x = element_text(size = 14)) +
theme(axis.title.x = element_text(size = 14)) +
theme(axis.title.y = element_text(size = 14))
#plot p2
p2
#gather the data with respect the the distance from the bundle that the monkey bid
p3 <- task_data %>%
.[, c("bundle_position", "bundle_water_perc", "offer_value", "trial", "bundle_distance", "block")] %>%
gather(-c(bundle_distance, block), key = "var", value = "value") %>%
#plot the monkeys bundle distance against all other variables
ggplot(aes(x = value, y = bundle_distance)) +
geom_point(alpha = 0.6, size = 2, aes(colour = block)) +
stat_smooth() +
scale_color_brewer(palette = "Set1", name = "Block") +
coord_flip() +
ggtitle("Monkey Bid Distance From Bundle on Binary Choice Task",
subtitle = paste(date, ";", monkey, ";", length(unique(task_data$block)), "blocks")) +
#theme_fivethirtyeight() +
theme_minimal() +
theme(strip.text.x = element_text(size = 14)) +
theme(axis.title.x = element_text(size = 14)) +
theme(axis.title.y = element_text(size = 14)) +
facet_wrap(~ var, scales = "free")
#plot p3
p3
#generate a model of likelihood to bid for the fractal dependent on it's position,
#value and associated water
model <- glm(data = task_data,
fractal_bid ~ bundle_position + bundle_water_perc + offer_value + trial,
family = "binomial")
#summarise the parameters
summary(model)
test <- task_data[, list(fractal_bid, offer_value, bundle_liquid)]
ggplot(data = test, aes(x = bundle_liquid, y = fractal_bid, colour = offer_value)) + geom_point(size = 3, alpha = 0.1)
ggplot(test[, .(.N), by = .(offer_value, bundle_liquid)], aes(x = ((offer_value*2 -1) * 0.15), y = bundle_liquid)) +
geom_tile(aes(fill = N)) +
scale_fill_continuous(low = "lightblue", high = "darkred", name = "number of trials") +
xlab("bundle juice offer") +
ylab("bundle water offer")
test2 <- test[!is.na(fractal_bid)] %>%
.[, mean(fractal_bid), by = .(offer_value, bundle_liquid)]
test2 <- task_data[!is.na(fractal_bid)] %>%
.[, mean(fractal_bid), by = .(offer_value, bundle_liquid)]
View(test2)
ggplot(data = task_data, aes(x = bundle_liquid, y = fractal_bid, colour = offer_value)) + geom_point(size = 3, alpha = 0.1)
ggplot(task_data[, .(.N), by = .(offer_value, bundle_liquid)], aes(x = ((offer_value*2 -1) * 0.15), y = bundle_liquid)) +
geom_tile(aes(fill = N)) +
scale_fill_continuous(low = "lightblue", high = "darkred", name = "number of trials") +
xlab("bundle juice offer") +
ylab("bundle water offer")
bundle_bidding <- task_data[!is.na(fractal_bid)] %>%
.[, mean(fractal_bid), by = .(offer_value, bundle_liquid)]
ggplot(bundle_bidding, aes(x = V1, y = bundle_liquid * 1.2, colour = (offer_value*2 -1) * 0.15))) +
geom_point()
ggplot(bundle_bidding, aes(x = V1, y = bundle_liquid * 1.2, colour = (offer_value*2 -1) * 0.15)) +
geom_point()
ggplot(bundle_bidding, aes(y = V1, x = bundle_liquid * 1.2, colour = (offer_value*2 -1) * 0.15)) +
geom_point()
ggplot(bundle_bidding, aes(y = V1, x = bundle_liquid * 1.2, colour = (offer_value*2 -1) * 0.15)) +
geom_point() +
scale_colour_continuous(low = "lightblue", high = "darkred", name = "juice offered (ml)") +
xlab("water offered (ml)") +
ylab("proportion of bundle choices")
ggplot(bundle_bidding, aes(y = V1, x = bundle_liquid * 1.2, colour = (offer_value*2 -1) * 0.15)) +
geom_point(size = 3, alpha = 0.3) +
scale_colour_continuous(low = "lightblue", high = "darkred", name = "juice offered (ml)") +
xlab("water offered (ml)") +
ylab("proportion of bundle choices")
ggplot(bundle_bidding, aes(y = V1, x = bundle_liquid * 1.2, colour = (offer_value*2 -1) * 0.15)) +
geom_point(size = 3, alpha = 0.3) +
geom_smooth() +
scale_colour_continuous(low = "lightblue", high = "darkred", name = "juice offered (ml)") +
xlab("water offered (ml)") +
ylab("proportion of bundle choices")
ggplot(bundle_bidding, aes(y = V1, x = bundle_liquid * 1.2, colour = as.factor((offer_value*2 -1) * 0.15))) +
geom_point(size = 3, alpha = 0.3) +
geom_smooth() +
scale_colour_continuous(low = "lightblue", high = "darkred", name = "juice offered (ml)") +
xlab("water offered (ml)") +
ylab("proportion of bundle choices")
ggplot(bundle_bidding, aes(y = V1, x = bundle_liquid * 1.2, colour = as.factor((offer_value*2 -1) * 0.15))) +
geom_point(size = 3, alpha = 0.3) +
geom_smooth() +
scale_colour_manual(values = c("red", "blue", "green"), name = "juice offered (ml)") +
xlab("water offered (ml)") +
ylab("proportion of bundle choices")
p4 <- task_data[, .(.N), by = .(offer_value, bundle_liquid)] %>%
ggplot(aes(x = ((offer_value*2 -1) * 0.15), y = bundle_liquid * 1.2)) +
geom_tile(aes(fill = N)) +
scale_fill_continuous(low = "lightblue", high = "darkred", name = "number of trials") +
xlab("bundle juice offer") +
ylab("bundle water offer")
p4
p4 <- task_data[, .(.N), by = .(offer_value, bundle_liquid)] %>%
ggplot(aes(x = ((offer_value*2 -1) * 0.15), y = bundle_liquid * 1.2)) +
geom_tile(aes(fill = N)) +
scale_fill_continuous(low = "lightblue", high = "darkred", name = "number of trials") +
xlab("bundle juice offer") +
ylab("bundle water offer")
task_data[, .(.N), by = .(offer_value, bundle_liquid)]
View(task_data)
ggplot(bundle_bidding, aes(y = V1, x = bundle_liquid * 1.2, colour = as.factor((offer_value*2 -1) * 0.15))) +
geom_point(size = 3, alpha = 0.3) +
binomial_smooth() +
scale_colour_manual(values = c("red", "blue", "green"), name = "juice offered (ml)") +
xlab("water offered (ml)") +
ylab("proportion of bundle choices")
binomial_smooth <- function(...) {
geom_smooth(method = "glm", method.args = list(family = "binomial"), ...)
}
ggplot(bundle_bidding, aes(y = V1, x = bundle_liquid * 1.2, colour = as.factor((offer_value*2 -1) * 0.15))) +
geom_point(size = 3, alpha = 0.3) +
binomial_smooth() +
scale_colour_manual(values = c("red", "blue", "green"), name = "juice offered (ml)") +
xlab("water offered (ml)") +
ylab("proportion of bundle choices")
p4 <- task_data[, .(.N), by = .(offer_value, bundle_liquid)] %>%
ggplot(aes(x = ((offer_value*2 -1) * 0.15), y = bundle_liquid * 1.2)) +
geom_tile(aes(fill = N)) +
scale_fill_continuous(low = "lightblue", high = "darkred", name = "number of trials") +
xlab("bundle juice offer") +
ylab("bundle water offer")
bundle_bidding <- task_data[!is.na(fractal_bid)] %>%
.[, mean(fractal_bid), by = .(offer_value, bundle_liquid)]
binomial_smooth <- function(...) {
geom_smooth(method = "glm", method.args = list(family = "binomial"), ...)
}
p5 <- ggplot(bundle_bidding, aes(y = V1, x = bundle_liquid * 1.2, colour = as.factor((offer_value*2 -1) * 0.15))) +
geom_point(size = 3, alpha = 0.3) +
binomial_smooth(se = FALSE) +
scale_colour_manual(values = c("red", "blue", "green"), name = "juice offered (ml)") +
xlab("water offered (ml)") +
ylab("proportion of bundle choices")
p5
p5 <- ggplot(bundle_bidding, aes(y = V1, x = bundle_liquid * 1.2, colour = as.factor((offer_value*2 -1) * 0.15))) +
geom_point(size = 3, alpha = 0.3) +
binomial_smooth(se = FALSE) +
scale_colour_brewer(palette = "Set1", name = "juice offered (ml)") +
xlab("water offered (ml)") +
ylab("proportion of bundle choices") +
ggtitle("Monkey Proportion of Bundle Bids on Binary Choice Task",
subtitle = paste(date, ";", monkey, ";", length(unique(task_data$block)), "blocks")) +
#theme_fivethirtyeight() +
theme_minimal() +
theme(strip.text.x = element_text(size = 14)) +
theme(axis.title.x = element_text(size = 14)) +
theme(axis.title.y = element_text(size = 14)) +
facet_wrap(~ var, scales = "free")
p5
p4 <- task_data[, .(.N), by = .(offer_value, bundle_liquid)] %>%
ggplot(aes(x = ((offer_value*2 -1) * 0.15), y = bundle_liquid * 1.2)) +
geom_tile(aes(fill = N)) +
scale_fill_continuous(low = "lightblue", high = "darkred", name = "number of trials") +
xlab("bundle juice offer") +
ylab("bundle water offer")
bundle_bidding <- task_data[!is.na(fractal_bid)] %>%
.[, mean(fractal_bid), by = .(offer_value, bundle_liquid)]
binomial_smooth <- function(...) {
geom_smooth(method = "glm", method.args = list(family = "binomial"), ...)
}
p5 <- ggplot(bundle_bidding, aes(y = V1, x = bundle_liquid * 1.2, colour = as.factor((offer_value*2 -1) * 0.15))) +
geom_point(size = 3, alpha = 0.3) +
binomial_smooth(se = FALSE) +
scale_colour_brewer(palette = "Set1", name = "juice offered (ml)") +
xlab("water offered (ml)") +
ylab("proportion of bundle choices") +
ggtitle("Monkey Proportion of Bundle Bids on Binary Choice Task",
subtitle = paste(date, ";", monkey, ";", length(unique(task_data$block)), "blocks")) +
#theme_fivethirtyeight() +
theme_minimal() +
theme(strip.text.x = element_text(size = 14)) +
theme(axis.title.x = element_text(size = 14)) +
theme(axis.title.y = element_text(size = 14))
p5
p4 <- task_data[, .(.N), by = .(offer_value, bundle_liquid)] %>%
ggplot(aes(x = ((offer_value*2 -1) * 0.15), y = bundle_liquid * 1.2)) +
geom_tile(aes(fill = N)) +
scale_fill_continuous(low = "lightblue", high = "darkred", name = "number of trials") +
xlab("bundle juice offer") +
ylab("bundle water offer")
bundle_bidding <- task_data[!is.na(fractal_bid)] %>%
.[, mean(fractal_bid), by = .(offer_value, bundle_liquid)]
binomial_smooth <- function(...) {
geom_smooth(method = "glm", method.args = list(family = "binomial"), ...)
}
p5 <- ggplot(bundle_bidding, aes(y = V1, x = bundle_liquid * 1.2, colour = as.factor((offer_value*2 -1) * 0.15))) +
geom_point(size = 3, alpha = 0.5) +
binomial_smooth(se = FALSE) +
scale_colour_brewer(palette = "Set1", name = "juice offered (ml)") +
xlab("water offered (ml)") +
ylab("proportion of bundle choices") +
ggtitle("Monkey Proportion of Bundle Bids on Binary Choice Task",
subtitle = paste(date, ";", monkey, ";", length(unique(task_data$block)), "blocks")) +
#theme_fivethirtyeight() +
theme_minimal() +
theme(strip.text.x = element_text(size = 14)) +
theme(axis.title.x = element_text(size = 14)) +
theme(axis.title.y = element_text(size = 14))
p5
p4 <- task_data[, .(.N), by = .(offer_value, bundle_liquid)] %>%
ggplot(aes(x = ((offer_value*2 -1) * 0.15), y = bundle_liquid * 1.2)) +
geom_tile(aes(fill = N)) +
scale_fill_continuous(low = "lightblue", high = "darkred", name = "number of trials") +
xlab("bundle juice offer") +
ylab("bundle water offer") +
ggtitle("Monkey Bundle Trials on Binary Choice Task",
subtitle = paste(date, ";", monkey, ";", length(unique(task_data$block)), "blocks")) +
#theme_fivethirtyeight() +
theme_minimal() +
theme(strip.text.x = element_text(size = 14)) +
theme(axis.title.x = element_text(size = 14)) +
theme(axis.title.y = element_text(size = 14))
p4
p4 <- task_data[!is.na(fractal_bid), .(.N), by = .(offer_value, bundle_liquid)] %>%
ggplot(aes(x = ((offer_value*2 -1) * 0.15), y = bundle_liquid * 1.2)) +
geom_tile(aes(fill = N)) +
scale_fill_continuous(low = "lightblue", high = "darkred", name = "number of trials") +
xlab("bundle juice offered (ml)") +
ylab("bundle water offered (ml)") +
ggtitle("Monkey Bundle Trials on Binary Choice Task",
subtitle = paste(date, ";", monkey, ";", length(unique(task_data$block)), "blocks")) +
#theme_fivethirtyeight() +
theme_minimal() +
theme(strip.text.x = element_text(size = 14)) +
theme(axis.title.x = element_text(size = 14)) +
theme(axis.title.y = element_text(size = 14))
#plot p4
p4
require(ggplot2)
require(ggthemes)
require(dplyr)
require(magrittr)
require(data.table)
require(tidyr)
#load in specific data
date <- "12-Dec-2017"
monkey <- "Ulysses"
search_string <- paste0(date, ".*", monkey, "COMPACT")
#find all data files
data_files <- dir("../savefiles")
#load in the relevant data
specific_files <- data_files[grep(search_string, data_files)]
task_data <- rbindlist(lapply(paste0("../savefiles/", specific_files), read.csv, na.strings = "NaN"), idcol = "block") %>%
#munge the data
.[, block := paste("block", block)] %>%
.[, trial:= 1:.N, block] %>%
.[bundle_position == 1, bundle_distance := (monkey_final_bid + 1)/2] %>%
.[bundle_position == 0, bundle_distance := (1-monkey_final_bid)/2] %>%
.[bundle_distance < 0.5, fractal_bid := 1] %>%
.[bundle_distance > 0.5, fractal_bid := 0] %>%
.[, offer_ml := paste0(((offer_value*2)-1) * 0.15, "ml")] %>%
.[, bundle_liquid := 1 - bundle_water_perc]
date
monkey
#plot the left vs right choices of the monkey
p1 <- ggplot(data = task_data, aes(x = monkey_final_bid, y = bundle_position)) +
geom_point(alpha = 0.4, aes(colour = trial, size = offer_value, shape = as.factor(fractal_bid))) +
scale_colour_continuous(low = "blue", high = "red", name = "trial number") +
scale_size_continuous(range = c(4,6), name = "juice offered") +
scale_shape_manual(values = c(15,16), name = "juice chosen") +
xlab("bid position") +
ylab("fractal position") +
annotate("text", label = "left bid", x = -0.5, y = 0.45, size = 7, colour = "darkgrey") +
annotate("text", label = "right bid", x = 0.5, y = 0.45, size = 7, colour = "darkgrey") +
ggtitle("Monkey Bid Positions on Binary Choice Task",
subtitle = paste(date, ";", monkey, ";", length(unique(task_data$block)), "blocks")) +
#theme_fivethirtyeight() +
theme_minimal() +
theme(strip.text.x = element_text(size = 14)) +
theme(axis.title.x = element_text(size = 14)) +
theme(axis.title.y = element_text(size = 14)) +
facet_wrap("block")
#plot p1
p1
#plot the distance from the bundle (0-1 of screen width) of the final bid
p2 <- ggplot(data = task_data, aes(x = bundle_distance, colour = as.factor(offer_ml))) +
geom_freqpoly(size = 3, alpha = 0.75) +
scale_colour_brewer(palette = "Set1", name = "fractal value") +
xlab("bid distance from bundle edge") +
ylab("count") +
annotate("text", label = "bundle bid", x = 0.05, y = 4, size = 7, colour = "darkgrey") +
annotate("text", label = "budget bid", x = 0.75, y = 4, size = 7, colour = "darkgrey") +
ggtitle("Monkey Bid Distance From Bundle on Binary Choice Task",
subtitle = paste(date, ";", monkey, ";", length(unique(task_data$block)), "blocks")) +
#theme_fivethirtyeight() +
theme_minimal() +
theme(strip.text.x = element_text(size = 14)) +
theme(axis.title.x = element_text(size = 14)) +
theme(axis.title.y = element_text(size = 14))
#plot p2
p2
#gather the data with respect the the distance from the bundle that the monkey bid
p3 <- task_data %>%
.[, c("bundle_position", "bundle_water_perc", "offer_value", "trial", "bundle_distance", "block")] %>%
gather(-c(bundle_distance, block), key = "var", value = "value") %>%
#plot the monkeys bundle distance against all other variables
ggplot(aes(x = value, y = bundle_distance)) +
geom_point(alpha = 0.6, size = 2, aes(colour = block)) +
stat_smooth() +
scale_color_brewer(palette = "Set1", name = "Block") +
coord_flip() +
ggtitle("Monkey Bid Distance From Bundle on Binary Choice Task",
subtitle = paste(date, ";", monkey, ";", length(unique(task_data$block)), "blocks")) +
#theme_fivethirtyeight() +
theme_minimal() +
theme(strip.text.x = element_text(size = 14)) +
theme(axis.title.x = element_text(size = 14)) +
theme(axis.title.y = element_text(size = 14)) +
facet_wrap(~ var, scales = "free")
#plot p3
p3
#generate a model of likelihood to bid for the fractal dependent on it's position,
#value and associated water
model <- glm(data = task_data,
fractal_bid ~ bundle_position + bundle_water_perc + offer_value + trial,
family = "binomial")
#summarise the parameters
summary(model)
p4 <- task_data[!is.na(fractal_bid), .(.N), by = .(offer_value, bundle_liquid)] %>%
ggplot(aes(x = ((offer_value*2 -1) * 0.15), y = bundle_liquid * 1.2)) +
geom_tile(aes(fill = N)) +
scale_fill_continuous(low = "lightblue", high = "darkred", name = "number of trials") +
xlab("bundle juice offered (ml)") +
ylab("bundle water offered (ml)") +
ggtitle("Monkey Bundle Trials on Binary Choice Task",
subtitle = paste(date, ";", monkey, ";", length(unique(task_data$block)), "blocks")) +
#theme_fivethirtyeight() +
theme_minimal() +
theme(strip.text.x = element_text(size = 14)) +
theme(axis.title.x = element_text(size = 14)) +
theme(axis.title.y = element_text(size = 14))
#plot p4
p4
bundle_bidding <- task_data[!is.na(fractal_bid)] %>%
.[, mean(fractal_bid), by = .(offer_value, bundle_liquid)]
binomial_smooth <- function(...) {
geom_smooth(method = "glm", method.args = list(family = "binomial"), ...)
}
p5 <- ggplot(bundle_bidding, aes(y = V1, x = bundle_liquid * 1.2, colour = as.factor((offer_value*2 -1) * 0.15))) +
geom_point(size = 3, alpha = 0.5) +
binomial_smooth(se = FALSE) +
scale_colour_brewer(palette = "Set1", name = "juice offered (ml)") +
xlab("water offered (ml)") +
ylab("proportion of bundle choices") +
ggtitle("Monkey Proportion of Bundle Bids on Binary Choice Task",
subtitle = paste(date, ";", monkey, ";", length(unique(task_data$block)), "blocks")) +
#theme_fivethirtyeight() +
theme_minimal() +
theme(strip.text.x = element_text(size = 14)) +
theme(axis.title.x = element_text(size = 14)) +
theme(axis.title.y = element_text(size = 14))
#plot p5
p5
